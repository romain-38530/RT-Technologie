(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[739],{7995:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/storage-market",function(){return s(9604)}])},4989:function(e,t,s){"use strict";s.d(t,{q:function(){return n}});let a=s(2019).env.NEXT_PUBLIC_STORAGE_MARKET_API_URL||"http://localhost:3013";async function r(e,t){let s=localStorage.getItem("admin_jwt"),r={"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...null==t?void 0:t.headers},n=await fetch("".concat(a).concat(e),{...t,headers:r});if(!n.ok)throw Error((await n.json().catch(()=>({error:"Unknown error"}))).error||"HTTP ".concat(n.status));return n.json()}let n={getStats:async()=>(await r("/storage-market/admin/stats")).stats,getAllNeeds:async e=>{let t=new URLSearchParams;(null==e?void 0:e.status)&&t.set("status",e.status),(null==e?void 0:e.ownerOrgId)&&t.set("ownerOrgId",e.ownerOrgId);let s=t.toString();return(await r(s?"/storage-market/needs?".concat(s):"/storage-market/needs")).items},getNeed:async e=>(await r("/storage-market/needs/".concat(e))).need,moderateNeed:async(e,t)=>(await r("/storage-market/needs/".concat(e),{method:"PUT",body:JSON.stringify(t)})).need,getLogisticians:async()=>(await r("/storage-market/admin/logisticians")).items,approveLogistician:async e=>(await r("/storage-market/admin/logisticians/".concat(e,"/approve"),{method:"POST"})).subscription,rejectLogistician:async(e,t)=>(await r("/storage-market/admin/logisticians/".concat(e,"/reject"),{method:"POST",body:JSON.stringify({reason:t})})).subscription,suspendLogistician:async(e,t)=>(await r("/storage-market/admin/logisticians/".concat(e,"/suspend"),{method:"POST",body:JSON.stringify({reason:t})})).subscription,getAllContracts:async e=>{let t=new URLSearchParams;(null==e?void 0:e.status)&&t.set("status",e.status),(null==e?void 0:e.industrialId)&&t.set("industrialId",e.industrialId),(null==e?void 0:e.logisticianId)&&t.set("logisticianId",e.logisticianId);let s=t.toString();return(await r(s?"/storage-market/contracts?".concat(s):"/storage-market/contracts")).items},getContract:async e=>(await r("/storage-market/contracts/".concat(e))).contract,updateContractStatus:async(e,t,s)=>(await r("/storage-market/contracts/".concat(e,"/status"),{method:"PUT",body:JSON.stringify({status:t,reason:s})})).contract,getOffersForNeed:async e=>(await r("/storage-market/offers/".concat(e))).items,getHealthMetrics:async()=>{let e=await n.getStats();return{averageResponseTime:0,successRate:e.activeContracts/e.totalContracts||0,activeUsers:0,totalRevenue:0}},exportToCSV:(e,t)=>{let s=Object.keys(e[0]||{}),a=new Blob([[s.join(","),...e.map(e=>s.map(t=>JSON.stringify(e[t]||"")).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(a),r.download=t,r.click()},generateMonthlyReport:async(e,t)=>{throw Error("\xc0 impl\xe9menter - endpoint avec filtres de date requis")}}},9604:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(7458),r=s(2983),n=s(4989);function i(){let[e,t]=(0,r.useState)(null),[s,i]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null);return((0,r.useEffect)(()=>{(async()=>{try{i(!0);let e=await n.q.getStats();t(e)}catch(e){console.error("Error fetching stats:",e),o(e instanceof Error?e.message:"Failed to load stats")}finally{i(!1)}})()},[]),s)?(0,a.jsx)("div",{className:"container mx-auto p-6",children:(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Chargement des statistiques..."})]})})}):c||!e?(0,a.jsx)("div",{className:"container mx-auto p-6",children:(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("p",{className:"text-red-800",children:["Erreur: ",c||"Impossible de charger les statistiques"]})})}):(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Dashboard Bourse de Stockage"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Vue d'ensemble et gestion du march\xe9"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Besoins publi\xe9s"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.totalNeeds}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:Object.entries(e.needsByStatus).map(e=>{let[t,s]=e;return(0,a.jsxs)("span",{className:"mr-2",children:[t,": ",s]},t)})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Offres soumises"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.totalOffers}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Moyenne: ",e.averageOffersPerNeed.toFixed(1),"/besoin"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Contrats actifs"}),(0,a.jsxs)("div",{className:"text-3xl font-bold",children:[e.activeContracts,"/",e.totalContracts]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Taux: ",e.totalNeeds>0?(e.totalContracts/e.totalNeeds*100).toFixed(0):0,"%"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Sites logistiques"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.totalSites}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Capacit\xe9s disponibles"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"R\xe9partition par type de stockage"}),(0,a.jsx)("div",{className:"space-y-3",children:[{type:"Long terme",count:6,percent:40},{type:"Temporaire",count:4,percent:27},{type:"Picking",count:3,percent:20},{type:"Cross-dock",count:2,percent:13}].map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{children:e.type}),(0,a.jsxs)("span",{className:"text-gray-600",children:[e.count," contrats"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(e.percent,"%")}})})]},e.type))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Top r\xe9gions actives"}),(0,a.jsx)("div",{className:"space-y-3",children:[{region:"\xcele-de-France",count:5},{region:"Auvergne-Rh\xf4ne-Alpes",count:3},{region:"Hauts-de-France",count:2},{region:"Provence-Alpes-C\xf4te d'Azur",count:2}].map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:e.region}),(0,a.jsx)("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-medium",children:e.count})]},e.region))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("a",{href:"/storage-market/needs",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"G\xe9rer les besoins"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Superviser toutes les publications"})]}),(0,a.jsxs)("a",{href:"/storage-market/logisticians",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"G\xe9rer les logisticiens"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Valider les abonnements"})]}),(0,a.jsxs)("a",{href:"/storage-market/analytics",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Analytics avanc\xe9s"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Rapports et statistiques"})]})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=7995)}),_N_E=e.O()}]);