(()=>{var e={};e.id=214,e.ids=[214,888,660],e.modules={5059:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},3940:(e,t,s)=>{"use strict";s.r(t),s.d(t,{config:()=>b,default:()=>y,getServerSideProps:()=>j,getStaticPaths:()=>m,getStaticProps:()=>f,reportWebVitals:()=>v,routeModule:()=>k,unstable_getServerProps:()=>R,unstable_getServerSideProps:()=>E,unstable_getStaticParams:()=>A,unstable_getStaticPaths:()=>P,unstable_getStaticProps:()=>S});var i={};s.r(i),s.d(i,{default:()=>x});var r=s(4614),n=s(2933),l=s(5059),a=s(6801),d=s.n(a),o=s(50),c=s(997),p=s(6689);let h=process.env.NEXT_PUBLIC_PALETTE_API_URL||"http://localhost:3011";async function g(e,t){let s={"Content-Type":"application/json",...t?.headers},i=await fetch(`${h}${e}`,{...t,headers:s});if(!i.ok)throw Error((await i.json().catch(()=>({error:"Unknown error"}))).error||`HTTP ${i.status}`);return i.json()}let u={getAllCheques:async()=>{throw Error("Endpoint non disponible - \xc0 impl\xe9menter dans le service palette")},getCheque:async e=>(await g(`/palette/cheques/${e}`)).cheque,getAllLedgers:async e=>await Promise.all(e.map(e=>u.getLedger(e))),getLedger:async e=>(await g(`/palette/ledger/${e}`)).ledger,getSites:async()=>(await g("/palette/sites")).sites,getSite:async e=>g(`/palette/sites/${e}`),updateSiteQuota:async(e,t)=>(await g(`/palette/sites/${e}/quota`,{method:"POST",body:JSON.stringify(t)})).quota,createSite:async e=>{throw Error("Endpoint non disponible - \xc0 impl\xe9menter dans le service palette")},deactivateSite:async e=>{throw Error("Endpoint non disponible - \xc0 impl\xe9menter dans le service palette")},getDisputes:async()=>(await g("/palette/disputes")).disputes,resolveDispute:async(e,t,s)=>{throw Error("Endpoint non disponible - \xc0 impl\xe9menter dans le service palette")},getAnalytics:async()=>{throw Error("Endpoint non disponible - Calcul\xe9 c\xf4t\xe9 client \xe0 partir des donn\xe9es")},exportToCSV:(e,t)=>{}};function x(){let[e,t]=(0,p.useState)("dashboard"),[s,i]=(0,p.useState)(!1),[r,n]=(0,p.useState)(null),[l,a]=(0,p.useState)([]),[d,o]=(0,p.useState)([]),[h,g]=(0,p.useState)([]),[x,y]=(0,p.useState)(null),[f,m]=(0,p.useState)(null),[j,b]=(0,p.useState)("ALL"),[v,S]=(0,p.useState)("");async function P(){i(!0),n(null);try{let[e,t]=await Promise.all([u.getSites(),u.getDisputes()]);a(e),g(t);let s=[...new Set(e.map(e=>e.companyId))],i=await u.getAllLedgers(s);o(i)}catch(e){n(e.message)}finally{i(!1)}}async function A(e){try{let{quota:t}=await u.getSite(e);m(t),y(e)}catch(e){n(e.message)}}async function R(e,t){try{let s=await u.updateSiteQuota(e,{dailyMax:t});m(s);let i=await u.getSites();a(i),alert("Quota mis \xe0 jour avec succ\xe8s")}catch(e){n(e.message)}}let E={totalSites:l.length,totalLedgers:d.length,totalDisputes:h.length,openDisputes:h.filter(e=>"OPEN"===e.status).length,totalPallets:d.reduce((e,t)=>e+Math.abs(t.balance),0),positiveBalances:d.filter(e=>e.balance>0).length,negativeBalances:d.filter(e=>e.balance<0).length},k=[...d].filter(e=>e.balance>0).sort((e,t)=>t.balance-e.balance).slice(0,5),w=[...d].filter(e=>e.balance<0).sort((e,t)=>e.balance-t.balance).slice(0,5);return l.map(e=>({...e,quotaConsumed:0})),(0,c.jsxs)("div",{style:{maxWidth:1400,margin:"0 auto",padding:16},children:[(0,c.jsxs)("header",{style:{marginBottom:24},children:[c.jsx("h1",{style:{fontSize:32,marginBottom:8},children:"Administration Palettes Europe"}),c.jsx("p",{style:{opacity:.8},children:"Gestion centralis\xe9e des ch\xe8ques palettes, sites de retour, ledgers et litiges"})]}),c.jsx("nav",{style:{display:"flex",gap:8,borderBottom:"2px solid #eee",marginBottom:24},children:["dashboard","cheques","ledgers","sites","disputes","analytics"].map(s=>c.jsx("button",{onClick:()=>t(s),style:{padding:"10px 16px",border:"none",background:e===s?"#0a66ff":"transparent",color:e===s?"#fff":"#333",borderRadius:"8px 8px 0 0",cursor:"pointer",fontWeight:e===s?"bold":"normal"},children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),r&&(0,c.jsxs)("div",{style:{padding:16,background:"#fee",color:"#c00",borderRadius:8,marginBottom:16},children:["Erreur: ",r]}),s&&c.jsx("div",{style:{padding:16,textAlign:"center"},children:"Chargement..."}),"dashboard"===e&&(0,c.jsxs)("div",{children:[c.jsx("h2",{style:{fontSize:24,marginBottom:16},children:"Tableau de bord"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:24},children:[(0,c.jsxs)("div",{style:{padding:16,border:"1px solid #ddd",borderRadius:8,background:"#f9f9f9"},children:[c.jsx("div",{style:{fontSize:32,fontWeight:"bold",color:"#0a66ff"},children:E.totalSites}),c.jsx("div",{style:{opacity:.8},children:"Sites de retour"})]}),(0,c.jsxs)("div",{style:{padding:16,border:"1px solid #ddd",borderRadius:8,background:"#f9f9f9"},children:[c.jsx("div",{style:{fontSize:32,fontWeight:"bold",color:"#0a66ff"},children:E.totalLedgers}),c.jsx("div",{style:{opacity:.8},children:"Entreprises"})]}),(0,c.jsxs)("div",{style:{padding:16,border:"1px solid #ddd",borderRadius:8,background:"#f9f9f9"},children:[c.jsx("div",{style:{fontSize:32,fontWeight:"bold",color:"#0a66ff"},children:E.totalPallets}),c.jsx("div",{style:{opacity:.8},children:"Palettes en circulation"})]}),(0,c.jsxs)("div",{style:{padding:16,border:"1px solid #ddd",borderRadius:8,background:"#fee"},children:[c.jsx("div",{style:{fontSize:32,fontWeight:"bold",color:"#c00"},children:E.openDisputes}),c.jsx("div",{style:{opacity:.8},children:"Litiges ouverts"})]})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:24},children:[(0,c.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:8,padding:16},children:[c.jsx("h3",{style:{fontSize:18,marginBottom:12,color:"#080"},children:"Plus gros cr\xe9dits (palettes en stock)"}),0===k.length?c.jsx("p",{style:{opacity:.6},children:"Aucun cr\xe9dit"}):c.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:k.map(e=>(0,c.jsxs)("li",{style:{padding:"8px 0",borderBottom:"1px solid #eee"},children:[c.jsx("strong",{children:e.companyId}),": +",e.balance," palettes"]},e.companyId))})]}),(0,c.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:8,padding:16},children:[c.jsx("h3",{style:{fontSize:18,marginBottom:12,color:"#c00"},children:"Plus grosses dettes (palettes emprunt\xe9es)"}),0===w.length?c.jsx("p",{style:{opacity:.6},children:"Aucune dette"}):c.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:w.map(e=>(0,c.jsxs)("li",{style:{padding:"8px 0",borderBottom:"1px solid #eee"},children:[c.jsx("strong",{children:e.companyId}),": ",e.balance," palettes"]},e.companyId))})]})]}),c.jsx("button",{onClick:P,style:{padding:"10px 16px",background:"#0a66ff",color:"#fff",border:"none",borderRadius:8,cursor:"pointer"},children:"Rafra\xeechir les donn\xe9es"})]}),"cheques"===e&&(0,c.jsxs)("div",{children:[c.jsx("h2",{style:{fontSize:24,marginBottom:16},children:"Ch\xe8ques Palettes"}),c.jsx("p",{style:{opacity:.8,marginBottom:16},children:"Fonctionnalit\xe9 \xe0 venir : Liste compl\xe8te des ch\xe8ques g\xe9n\xe9r\xe9s avec filtres par statut"}),(0,c.jsxs)("div",{style:{padding:16,border:"1px solid #fa0",borderRadius:8,background:"#fff9e6"},children:[c.jsx("strong",{children:"Note:"})," Le service palette ne fournit pas encore d'endpoint pour lister tous les ch\xe8ques. Il faut ajouter GET /palette/admin/cheques dans le service backend."]})]}),"ledgers"===e&&(0,c.jsxs)("div",{children:[c.jsx("h2",{style:{fontSize:24,marginBottom:16},children:"Ledgers des entreprises"}),c.jsx("button",{onClick:function(){let e=d.map(e=>({companyId:e.companyId,balance:e.balance,transactions:e.history.length,lastUpdate:e.history[e.history.length-1]?.date||"N/A"}));u.exportToCSV(e,"ledgers-palettes.csv")},style:{padding:"10px 16px",background:"#080",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",marginBottom:16},children:"Exporter CSV"}),(0,c.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[c.jsx("thead",{children:(0,c.jsxs)("tr",{style:{background:"#f0f0f0",borderBottom:"2px solid #ddd"},children:[c.jsx("th",{style:{padding:12,textAlign:"left"},children:"Company ID"}),c.jsx("th",{style:{padding:12,textAlign:"right"},children:"Solde (palettes)"}),c.jsx("th",{style:{padding:12,textAlign:"right"},children:"Transactions"}),c.jsx("th",{style:{padding:12,textAlign:"left"},children:"Derni\xe8re activit\xe9"})]})}),c.jsx("tbody",{children:d.map(e=>(0,c.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[c.jsx("td",{style:{padding:12},children:c.jsx("strong",{children:e.companyId})}),(0,c.jsxs)("td",{style:{padding:12,textAlign:"right",fontWeight:"bold",color:e.balance>0?"#080":e.balance<0?"#c00":"#666"},children:[e.balance>0?"+":"",e.balance]}),c.jsx("td",{style:{padding:12,textAlign:"right"},children:e.history.length}),c.jsx("td",{style:{padding:12},children:e.history.length>0?new Date(e.history[e.history.length-1].date).toLocaleString("fr-FR"):"N/A"})]},e.companyId))})]})]}),"sites"===e&&(0,c.jsxs)("div",{children:[c.jsx("h2",{style:{fontSize:24,marginBottom:16},children:"Sites de retour"}),c.jsx("button",{onClick:function(){let e=l.map(e=>({id:e.id,companyId:e.companyId,name:e.name,address:e.address,quotaDailyMax:e.quotaDailyMax,priority:e.priority}));u.exportToCSV(e,"sites-palettes.csv")},style:{padding:"10px 16px",background:"#080",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",marginBottom:16},children:"Exporter CSV"}),c.jsx("div",{style:{display:"grid",gap:16},children:l.map(e=>(0,c.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:8,padding:16},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[c.jsx("h3",{style:{fontSize:18,margin:0},children:e.name}),c.jsx("p",{style:{margin:"4px 0",opacity:.8},children:e.address}),(0,c.jsxs)("p",{style:{margin:"4px 0",fontSize:14},children:[c.jsx("strong",{children:"Propri\xe9taire:"})," ",e.companyId," | ",c.jsx("strong",{children:"Priorit\xe9:"})," ",e.priority]}),(0,c.jsxs)("p",{style:{margin:"4px 0",fontSize:14},children:[c.jsx("strong",{children:"Quota journalier:"})," ",e.quotaDailyMax," palettes"]}),(0,c.jsxs)("p",{style:{margin:"4px 0",fontSize:14},children:[c.jsx("strong",{children:"Horaires:"})," ",e.openingHours.start," - ",e.openingHours.end]})]}),c.jsx("div",{style:{display:"flex",gap:8},children:c.jsx("button",{onClick:()=>A(e.id),style:{padding:"8px 12px",background:"#0a66ff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer"},children:"G\xe9rer quota"})})]}),x===e.id&&f&&(0,c.jsxs)("div",{style:{marginTop:16,padding:16,background:"#f9f9f9",borderRadius:8},children:[c.jsx("h4",{style:{margin:"0 0 12px 0"},children:"Gestion du quota"}),(0,c.jsxs)("p",{children:[c.jsx("strong",{children:"Quota actuel:"})," ",f.dailyMax," | ",c.jsx("strong",{children:"Consomm\xe9:"})," ",f.consumed]}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:12},children:[c.jsx("input",{type:"number",id:`quota-${e.id}`,defaultValue:f.dailyMax,style:{padding:8,border:"1px solid #ddd",borderRadius:6,width:100}}),c.jsx("button",{onClick:()=>{let t=parseInt(document.getElementById(`quota-${e.id}`).value,10);t>0&&R(e.id,t)},style:{padding:"8px 12px",background:"#080",color:"#fff",border:"none",borderRadius:6,cursor:"pointer"},children:"Mettre \xe0 jour"})]})]})]},e.id))})]}),"disputes"===e&&(0,c.jsxs)("div",{children:[c.jsx("h2",{style:{fontSize:24,marginBottom:16},children:"Litiges"}),0===h.length?c.jsx("p",{style:{opacity:.6},children:"Aucun litige enregistr\xe9"}):c.jsx("div",{style:{display:"grid",gap:16},children:h.map(e=>(0,c.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:8,padding:16,background:"OPEN"===e.status?"#fff9e6":"#f9f9f9"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("h3",{style:{fontSize:18,margin:0},children:["Litige #",e.id]}),(0,c.jsxs)("p",{style:{margin:"4px 0"},children:[c.jsx("strong",{children:"Ch\xe8que:"})," ",e.chequeId," | ",c.jsx("strong",{children:"Plaignant:"})," ",e.claimantId]}),(0,c.jsxs)("p",{style:{margin:"4px 0"},children:[c.jsx("strong",{children:"Raison:"})," ",e.reason]}),(0,c.jsxs)("p",{style:{margin:"4px 0",fontSize:14,opacity:.8},children:["Cr\xe9\xe9 le ",new Date(e.createdAt).toLocaleString("fr-FR")]}),e.comments&&(0,c.jsxs)("p",{style:{margin:"8px 0",fontStyle:"italic"},children:['"',e.comments,'"']})]}),c.jsx("div",{style:{padding:"6px 12px",borderRadius:6,background:"OPEN"===e.status?"#fa0":"RESOLVED"===e.status?"#080":"#666",color:"#fff",fontSize:14,fontWeight:"bold"},children:e.status})]}),"OPEN"===e.status&&c.jsx("button",{onClick:()=>alert("Fonctionnalit\xe9 de r\xe9solution \xe0 impl\xe9menter"),style:{marginTop:12,padding:"8px 12px",background:"#080",color:"#fff",border:"none",borderRadius:6,cursor:"pointer"},children:"R\xe9soudre le litige"})]},e.id))})]}),"analytics"===e&&(0,c.jsxs)("div",{children:[c.jsx("h2",{style:{fontSize:24,marginBottom:16},children:"Analytics & Graphiques"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:24},children:[(0,c.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:8,padding:16},children:[c.jsx("h3",{style:{fontSize:18,marginBottom:12},children:"R\xe9partition des soldes"}),(0,c.jsxs)("div",{style:{display:"flex",gap:16,alignItems:"center",justifyContent:"center",height:200},children:[(0,c.jsxs)("div",{style:{textAlign:"center"},children:[c.jsx("div",{style:{fontSize:48,fontWeight:"bold",color:"#080"},children:E.positiveBalances}),c.jsx("div",{style:{opacity:.8},children:"Cr\xe9dits"})]}),(0,c.jsxs)("div",{style:{textAlign:"center"},children:[c.jsx("div",{style:{fontSize:48,fontWeight:"bold",color:"#c00"},children:E.negativeBalances}),c.jsx("div",{style:{opacity:.8},children:"Dettes"})]})]})]}),(0,c.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:8,padding:16},children:[c.jsx("h3",{style:{fontSize:18,marginBottom:12},children:"Sites par priorit\xe9"}),c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:["INTERNAL","NETWORK","EXTERNAL"].map(e=>{let t=l.filter(t=>t.priority===e).length;return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("div",{style:{width:100},children:e}),c.jsx("div",{style:{flex:1,background:"#eee",borderRadius:4,height:24,position:"relative"},children:c.jsx("div",{style:{background:"INTERNAL"===e?"#0a66ff":"NETWORK"===e?"#080":"#fa0",height:"100%",borderRadius:4,width:`${t/l.length*100}%`}})}),c.jsx("div",{style:{width:40,textAlign:"right"},children:t})]},e)})})]})]}),(0,c.jsxs)("div",{style:{padding:16,border:"1px solid #0a66ff",borderRadius:8,background:"#f0f8ff"},children:[c.jsx("strong",{children:"Graphiques avanc\xe9s:"})," \xc0 venir - \xc9volution des flux, pr\xe9dictions IA, heatmap g\xe9ographique"]})]})]})}let y=(0,l.l)(i,"default"),f=(0,l.l)(i,"getStaticProps"),m=(0,l.l)(i,"getStaticPaths"),j=(0,l.l)(i,"getServerSideProps"),b=(0,l.l)(i,"config"),v=(0,l.l)(i,"reportWebVitals"),S=(0,l.l)(i,"unstable_getStaticProps"),P=(0,l.l)(i,"unstable_getStaticPaths"),A=(0,l.l)(i,"unstable_getStaticParams"),R=(0,l.l)(i,"unstable_getServerProps"),E=(0,l.l)(i,"unstable_getServerSideProps"),k=new r.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/palettes",pathname:"/palettes",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:i})},50:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var i=s(997);function r({Component:e,pageProps:t}){let s=process.env.NEXT_PUBLIC_SUPPORT_URL||"https://www.rt-technologie.com";return i.jsx(i.Fragment,{children:(0,i.jsxs)("div",{className:"app-container",children:[i.jsx("header",{className:"app-header",children:(0,i.jsxs)("div",{className:"header-content",children:[(0,i.jsxs)("a",{href:"/",className:"logo",children:[i.jsx("div",{className:"logo-icon",children:"RT"}),i.jsx("span",{children:"Backoffice Admin"})]}),(0,i.jsxs)("nav",{className:"main-nav",children:[i.jsx("a",{href:"/",className:"nav-link",children:"Accueil"}),i.jsx("a",{href:"/orgs",className:"nav-link",children:"Organisations"}),i.jsx("a",{href:"/pricing",className:"nav-link",children:"Tarifs"}),i.jsx("a",{href:"/palettes",className:"nav-link",children:"Palettes"}),i.jsx("a",{href:"/health",className:"nav-link",children:"\xc9tat"}),i.jsx("a",{href:s,target:"_blank",rel:"noreferrer",className:"nav-link",children:"Support"}),i.jsx("a",{href:"/login",className:"btn btn-primary btn-sm",children:"Se connecter"})]})]})}),i.jsx("main",{className:"main-content",children:i.jsx(e,{...t})})]})})}s(1882)},1882:()=>{},2933:(e,t)=>{"use strict";var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},1017:e=>{"use strict";e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),i=t.X(0,[801],()=>s(3940));module.exports=i})();