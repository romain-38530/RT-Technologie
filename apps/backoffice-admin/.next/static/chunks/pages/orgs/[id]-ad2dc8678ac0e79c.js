(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[654],{9296:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orgs/[id]",function(){return n(1498)}])},1498:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return c}});var t=n(7458),l=n(2983),s=n(3731);let r="http://3.76.34.154:3000",i=[{value:"INDUSTRY_BASE",label:"Industrie — Base (499€)"},{value:"TRANSPORTER_BASE",label:"Transporteur — Base (499€)"}],o=[{value:"AFFRET_IA",label:"Affret.IA"},{value:"PREMIUM_MARKETPLACE",label:"Premium Marketplace"}];function c(){let{id:e}=(0,s.useRouter)().query,[a,n]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),[u,p]=(0,l.useState)(null),[h,f]=(0,l.useState)(!1),[x,v]=(0,l.useState)(null);(0,l.useEffect)(()=>{e&&(async()=>{try{let a={};{let e=window.localStorage.getItem("admin_jwt");e&&(a.authorization="Bearer ".concat(e))}let[t,l,s]=await Promise.all([fetch("".concat(r,"/admin/orgs/").concat(e),{headers:a}),fetch("".concat(r,"/admin/pricing"),{headers:a}),fetch("".concat(r,"/admin/orgs/").concat(e,"/features"),{headers:a})]);n(await t.json()),d(await l.json());let i=await s.json();p(i.features||[])}catch(e){v(e.message||"Erreur r\xe9seau")}})()},[e]);let j=e=>n(a=>{let n=new Set(a.addons||[]);return n.has(e)?n.delete(e):n.add(e),{...a,addons:Array.from(n)}}),m=async()=>{if(e){f(!0),v(null);try{let n={"content-type":"application/json"};{let e=window.localStorage.getItem("admin_jwt");e&&(n.authorization="Bearer ".concat(e))}await fetch("".concat(r,"/admin/orgs/").concat(e,"/plan"),{method:"POST",headers:n,body:JSON.stringify({plan:a.plan,addons:a.addons||[]})}),alert("Modifications enregistr\xe9es")}catch(e){v(e.message||"Erreur r\xe9seau")}finally{f(!1)}}};return e&&a&&c?(0,t.jsxs)("main",{children:[(0,t.jsxs)("h2",{children:["Organisation ",a.name," (",a.id,")"]}),x&&(0,t.jsx)("p",{style:{color:"red"},children:x}),(0,t.jsxs)("p",{children:["R\xf4le: ",a.role," — Statut: ",a.status]}),(0,t.jsx)("div",{style:{margin:"12px 0"},children:(0,t.jsxs)("label",{children:["Plan:\xa0",(0,t.jsxs)("select",{value:a.plan||"",onChange:e=>n(a=>({...a,plan:e.target.value})),children:[(0,t.jsx)("option",{value:"",children:"—"}),i.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{children:"Modules compl\xe9mentaires"}),o.map(e=>{var n,l;return(0,t.jsxs)("label",{style:{display:"block"},children:[(0,t.jsx)("input",{type:"checkbox",checked:(a.addons||[]).includes(e.value),onChange:()=>j(e.value)}),e.label," ",(null==c?void 0:null===(l=c.addons)||void 0===l?void 0:null===(n=l[e.value])||void 0===n?void 0:n.monthly)?"(+".concat(c.addons[e.value].monthly," €)"):""]},e.value)})]}),u&&(0,t.jsxs)("div",{style:{marginTop:12},children:[(0,t.jsx)("h3",{children:"Droits effectifs (plan+addons)"}),(0,t.jsx)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:u.map(e=>(0,t.jsx)("span",{style:{background:"#eef",padding:"4px 8px",borderRadius:6},children:e},e))}),(0,t.jsx)("p",{style:{opacity:.7},children:"Note: les transporteurs invit\xe9s h\xe9ritent de ces droits pour les flux appartenant \xe0 cette organisation."})]}),(0,t.jsx)("p",{style:{marginTop:12},children:(0,t.jsx)("a",{href:"/orgs/".concat(a.id,"/invitations"),children:"G\xe9rer les invitations transporteurs →"})}),(0,t.jsx)("button",{onClick:m,disabled:h,children:"Enregistrer"})]}):(0,t.jsx)("p",{children:"Chargement…"})}},3731:function(e,a,n){e.exports=n(6164)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=9296)}),_N_E=e.O()}]);