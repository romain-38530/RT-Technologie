# ============================================================================
# RT-Technologie - Environment Variables
# ============================================================================
# IMPORTANT: Copy this file to .env and fill in your actual values
# NEVER commit .env to Git (it contains secrets)
# ============================================================================

# ============================================================================
# ENVIRONMENT
# ============================================================================
NODE_ENV=production
PORT=3001

# ============================================================================
# DOMAIN & URLs
# ============================================================================
DOMAIN=rt-technologie.com
API_BASE_URL=https://api.rt-technologie.com
AUTH_BASE_URL=https://auth.rt-technologie.com
WWW_URL=https://www.rt-technologie.com

# ============================================================================
# MONGODB ATLAS
# ============================================================================
# Connection String (from MongoDB Atlas)
MONGODB_URI=mongodb+srv://app_user:CHANGE_ME_STRONG_PASSWORD@rt-production.xxxxx.mongodb.net
MONGODB_DB=rt-production

# MongoDB Atlas API (for Terraform/automation)
MONGODB_ATLAS_PUBLIC_KEY=your-atlas-public-key
MONGODB_ATLAS_PRIVATE_KEY=your-atlas-private-key
MONGODB_ATLAS_PROJECT_ID=your-project-id

# MongoDB Atlas Users
MONGODB_ATLAS_DB_USERNAME=app_user
MONGODB_ATLAS_DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD_256_BITS

# ============================================================================
# AWS CONFIGURATION
# ============================================================================
# AWS Credentials (use IAM roles in production, not hardcoded keys)
AWS_ACCESS_KEY_ID=AKIA_CHANGE_ME
AWS_SECRET_ACCESS_KEY=CHANGE_ME_SECRET_KEY_40_CHARS
AWS_REGION=eu-west-3
AWS_ACCOUNT_ID=123456789012

# S3 Buckets (created by Terraform)
AWS_S3_BUCKET_DOCUMENTS=rt-production-documents-xxxxx
AWS_S3_BUCKET_IMAGES=rt-production-images-xxxxx
AWS_S3_BUCKET_BACKUPS=rt-production-backups-xxxxx

# CloudFront CDN
CDN_DOCUMENTS_URL=https://cdn-docs.rt-technologie.com
CDN_IMAGES_URL=https://cdn-img.rt-technologie.com

# SES Email
AWS_SES_REGION=eu-west-1
NOTIFICATIONS_SES_FROM="RT Technologie <no-reply@rt-technologie.com>"

# ============================================================================
# SECURITY
# ============================================================================
# JWT Secret (generate with: openssl rand -base64 64)
AUTHZ_JWT_SECRET=CHANGE_ME_STRONG_JWT_SECRET_256_BITS_MINIMUM

# Internal Service Token (for service-to-service auth)
INTERNAL_SERVICE_TOKEN=CHANGE_ME_STRONG_SERVICE_TOKEN

# Admin API Key (for admin endpoints)
AUTHZ_ADMIN_API_KEY=CHANGE_ME_ADMIN_API_KEY

# Security Enforcement
SECURITY_ENFORCE=true

# CORS Allowed Origins (comma-separated)
CORS_ALLOW_ORIGIN=https://industry.rt-technologie.com,https://transporter.rt-technologie.com,https://logistician.rt-technologie.com,https://forwarder.rt-technologie.com,https://supplier.rt-technologie.com,https://recipient.rt-technologie.com,https://admin.rt-technologie.com,https://driver.rt-technologie.com,https://kiosk.rt-technologie.com

# ============================================================================
# SERVICES PORTS (Backend)
# ============================================================================
# Core Services
CORE_ORDERS_PORT=3001
NOTIFICATIONS_PORT=3002
TMS_SYNC_PORT=3003
PLANNING_PORT=3004
AFFRET_IA_PORT=3005
VIGILANCE_PORT=3006
AUTHZ_PORT=3007
ADMIN_GATEWAY_PORT=3008
ECPMR_PORT=3009

# Additional Services
PALETTE_PORT=3011
TRAINING_PORT=3012
STORAGE_MARKET_PORT=3013
PRICING_GRIDS_PORT=3014
TRACKING_IA_PORT=3015
BOURSE_PORT=3016
WMS_SYNC_PORT=3017
ERP_SYNC_PORT=3018

# ============================================================================
# SERVICES URLs (Internal - behind ALB)
# ============================================================================
CORE_ORDERS_URL=http://localhost:3001
NOTIFICATIONS_URL=http://localhost:3002
TMS_SYNC_URL=http://localhost:3003
PLANNING_URL=http://localhost:3004
AFFRET_IA_URL=http://localhost:3005
VIGILANCE_URL=http://localhost:3006
AUTHZ_URL=http://localhost:3007
ADMIN_GATEWAY_URL=http://localhost:3008
ECPMR_URL=http://localhost:3009
PALETTE_URL=http://localhost:3011
TRAINING_URL=http://localhost:3012
STORAGE_MARKET_URL=http://localhost:3013
PRICING_GRIDS_URL=http://localhost:3014
TRACKING_IA_URL=http://localhost:3015
BOURSE_URL=http://localhost:3016
WMS_SYNC_URL=http://localhost:3017
ERP_SYNC_URL=http://localhost:3018

# Public URLs (for external callbacks)
PUBLIC_CORE_ORDERS_URL=https://api.rt-technologie.com/api/orders
PUBLIC_NOTIFICATIONS_URL=https://api.rt-technologie.com/api/notifications
PUBLIC_AUTHZ_URL=https://auth.rt-technologie.com

# ============================================================================
# AUTHZ (Authentication & Authorization)
# ============================================================================
AUTHZ_VERIFY_BASE_URL=https://auth.rt-technologie.com
ENTITLEMENTS_TTL_MS=300000

# ============================================================================
# MAILGUN (Email Service)
# ============================================================================
MAILGUN_DOMAIN=mg.rt-technologie.com
MAILGUN_API_KEY=key-CHANGE_ME_MAILGUN_API_KEY
MAIL_FROM="RT Technologie <no-reply@rt-technologie.com>"

# Email Notification Recipients
DISPATCH_NOTIFY_TO=dispatch@rt-technologie.com
INDUSTRY_NOTIFY_TO=industry@rt-technologie.com
PLANNING_NOTIFY_TO=planning@rt-technologie.com

# ============================================================================
# OPENROUTER (LLM / AI)
# ============================================================================
OPENROUTER_API_KEY=sk-or-CHANGE_ME_OPENROUTER_API_KEY
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=openai/gpt-4o-mini
OPENROUTER_PROJECT=RT-Technologie
OPENROUTER_REFERER=https://www.rt-technologie.com

# AI Configuration
AFFRET_IA_MIN_SCORING=80
AFFRET_IA_PRICE_MARGIN=0.05

# ============================================================================
# VAT CHECK API (Vigilance Service)
# ============================================================================
VATCHECK_API_KEY=vat_live_CHANGE_ME_VATCHECK_API_KEY
VATCHECK_BASE_URL=https://app.vatcheckapi.com
VATCHECK_PATH=/api/validate
VIGILANCE_TTL_MS=300000

# ============================================================================
# FRONTEND ENVIRONMENT VARIABLES (NEXT_PUBLIC_*)
# ============================================================================
# These are exposed to the browser, so no secrets!

# API Endpoints
NEXT_PUBLIC_ADMIN_GATEWAY_URL=https://api.rt-technologie.com
NEXT_PUBLIC_AUTHZ_URL=https://auth.rt-technologie.com

# CDN URLs
NEXT_PUBLIC_CDN_DOCUMENTS=https://cdn-docs.rt-technologie.com
NEXT_PUBLIC_CDN_IMAGES=https://cdn-img.rt-technologie.com

# Support
NEXT_PUBLIC_SUPPORT_URL=https://support.rt-technologie.com
SUPPORT_EMAIL=support@rt-technologie.com
NEXT_PUBLIC_SUPPORT_EMAIL=support@rt-technologie.com

# Analytics (optional)
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX
NEXT_PUBLIC_HOTJAR_ID=

# Feature Flags
NEXT_PUBLIC_FEATURE_TRAINING=true
NEXT_PUBLIC_FEATURE_STORAGE_MARKET=true
NEXT_PUBLIC_FEATURE_AFFRET_IA=true
NEXT_PUBLIC_FEATURE_PALETTES=true

# ============================================================================
# CACHE & PERFORMANCE
# ============================================================================
# Redis (optional - for caching)
REDIS_URL=redis://localhost:6379
REDIS_TTL=3600

# Cache TTLs (milliseconds)
CACHE_TTL_DEFAULT=300000
CACHE_TTL_ENTITLEMENTS=300000
CACHE_TTL_VIGILANCE=300000

# ============================================================================
# MONITORING & LOGGING
# ============================================================================
# Log Level (error, warn, info, debug)
LOG_LEVEL=info

# DataDog (APM)
DD_AGENT_HOST=localhost
DD_TRACE_AGENT_PORT=8126
DD_SERVICE=rt-technologie
DD_ENV=production
DD_VERSION=1.0.0

# Sentry (Error Tracking)
SENTRY_DSN=https://xxxxx@sentry.io/xxxxx
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_PER_USER=1000

# ============================================================================
# FILE UPLOADS
# ============================================================================
MAX_FILE_SIZE_MB=10
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp,application/pdf

# ============================================================================
# BACKUP & RESTORE
# ============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 3 * * *"
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=rt-production-backups-xxxxx

# ============================================================================
# THIRD-PARTY INTEGRATIONS
# ============================================================================
# Stripe (Payments - if needed)
STRIPE_SECRET_KEY=sk_live_CHANGE_ME
STRIPE_PUBLISHABLE_KEY=pk_live_CHANGE_ME
STRIPE_WEBHOOK_SECRET=whsec_CHANGE_ME

# Twilio (SMS - if needed)
TWILIO_ACCOUNT_SID=AC_CHANGE_ME
TWILIO_AUTH_TOKEN=CHANGE_ME
TWILIO_PHONE_NUMBER=+33XXXXXXXXX

# Google Maps API (if needed)
GOOGLE_MAPS_API_KEY=CHANGE_ME

# ============================================================================
# DEVELOPMENT ONLY
# ============================================================================
# Skip email sending in dev
SKIP_EMAIL_SENDING=false

# Mock external APIs
MOCK_VAT_CHECK=false
MOCK_AI_MATCHING=false

# Debug mode
DEBUG=false
VERBOSE_LOGGING=false

# ============================================================================
# CI/CD SECRETS (GitHub Actions)
# ============================================================================
# These should be set in GitHub Secrets, not in .env

# GitHub Actions needs:
# - AWS_ACCESS_KEY_ID
# - AWS_SECRET_ACCESS_KEY
# - MONGODB_ATLAS_PUBLIC_KEY
# - MONGODB_ATLAS_PRIVATE_KEY
# - VERCEL_TOKEN
# - SLACK_WEBHOOK_URL

# ============================================================================
# TERRAFORM VARIABLES
# ============================================================================
# For Terraform, create terraform.tfvars:
# aws_region = "eu-west-3"
# environment = "production"
# domain_name = "rt-technologie.com"
# instance_type = "t3.medium"
# min_instances = 2
# max_instances = 10

# ============================================================================
# NOTES
# ============================================================================
# 1. Never commit .env to Git
# 2. Use strong passwords (min 32 chars, random)
# 3. Rotate secrets every 90 days
# 4. Use AWS Secrets Manager in production (not .env file)
# 5. Enable MFA for all AWS accounts
# 6. Use least privilege IAM roles
# 7. Monitor for unauthorized access
# 8. Keep dependencies up to date
# 9. Run security audits regularly
# 10. Test backups monthly

# ============================================================================
# GENERATE SECRETS
# ============================================================================
# Use these commands to generate strong secrets:
#
# JWT Secret (256 bits):
# openssl rand -base64 64
#
# Service Token (256 bits):
# openssl rand -hex 32
#
# Admin API Key (128 bits):
# openssl rand -base64 32
#
# MongoDB Password (strong):
# openssl rand -base64 32 | tr -d "=+/" | cut -c1-32

# ============================================================================
# AWS SECRETS MANAGER (Recommended for Production)
# ============================================================================
# Instead of using .env file, store secrets in AWS Secrets Manager:
#
# aws secretsmanager create-secret \
#   --name rt-technologie/production/env \
#   --secret-string file://.env \
#   --region eu-west-3
#
# Then in your app, fetch secrets:
#
# const { SecretString } = await secretsManager.getSecretValue({
#   SecretId: 'rt-technologie/production/env'
# }).promise();

# ============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# ============================================================================
# For different environments, create:
# - .env.development
# - .env.staging
# - .env.production
#
# Load with: NODE_ENV=production node -r dotenv/config app.js
