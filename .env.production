# ============================================
# RT-Technologie - Configuration Production
# ============================================
# IMPORTANT: Ne jamais committer ce fichier avec de vraies valeurs
# Sur AWS EC2, copiez ce fichier en .env et remplissez avec vos vraies clés

# ============================================
# MongoDB Configuration
# ============================================
# Option 1: MongoDB local (sur EC2)
MONGODB_ROOT_USERNAME=rt_admin
MONGODB_ROOT_PASSWORD=CHANGEZ_MOI_PRODUCTION_PASSWORD_FORT_123!

# Option 2: MongoDB Atlas (recommandé)
# Décommentez et utilisez cette ligne à la place
# MONGODB_URI=mongodb+srv://user:password@cluster0.xxxxx.mongodb.net/rt_technologie?retryWrites=true&w=majority

# ============================================
# Security & Authentication
# ============================================
# Générez des tokens forts pour la production
JWT_SECRET=CHANGEZ_MOI_jwt_secret_production_tres_long_et_securise_2025
INTERNAL_SERVICE_TOKEN=CHANGEZ_MOI_internal_token_production_securise_2025
AUTHZ_ADMIN_API_KEY=CHANGEZ_MOI_admin_api_key_production_securise

# ============================================
# Email / Notifications
# ============================================
# Option 1: Mailgun (recommandé)
MAILGUN_DOMAIN=mg.votre-domaine.com
MAILGUN_API_KEY=key-VOTRE_CLE_MAILGUN
MAIL_FROM="RT Technologie <no-reply@votre-domaine.com>"

# Option 2: SMTP générique
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=votre-email@example.com
SMTP_PASSWORD=VOTRE_MOT_DE_PASSE_SMTP

# Notifications
NOTIFICATIONS_PORT=3004
DISPATCH_NOTIFY_TO=dispatch@votre-entreprise.com
INDUSTRY_NOTIFY_TO=industry@votre-entreprise.com
PLANNING_NOTIFY_TO=planning@votre-entreprise.com
SUPPORT_EMAIL=support@votre-entreprise.com

# ============================================
# IA / LLM API Keys
# ============================================
# OpenRouter (pour Affret.IA et Chatbot)
OPENROUTER_API_KEY=sk-or-v1-VOTRE_CLE_OPENROUTER
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=openai/gpt-4o-mini
OPENROUTER_PROJECT=RT-Technologie-Production
OPENROUTER_REFERER=https://www.votre-domaine.com

# OpenAI (optionnel, si utilisation directe)
OPENAI_API_KEY=sk-VOTRE_CLE_OPENAI

# Anthropic (optionnel, si utilisation directe)
ANTHROPIC_API_KEY=sk-ant-VOTRE_CLE_ANTHROPIC

# ============================================
# Services externes
# ============================================
# TomTom API (pour Geo-Tracking)
TOMTOM_API_KEY=VOTRE_CLE_TOMTOM

# VAT Check API (validation TVA)
VATCHECK_API_KEY=vat_live_VOTRE_CLE_VATCHECK
VATCHECK_BASE_URL=https://app.vatcheckapi.com
VATCHECK_PATH=/api/validate

# ============================================
# AWS (optionnel)
# ============================================
# Recommandation: Utilisez IAM Roles au lieu de clés en dur
AWS_REGION=eu-west-3
AWS_S3_BUCKET=rt-production-docs
# AWS_ACCESS_KEY_ID=  # Utiliser IAM Role à la place
# AWS_SECRET_ACCESS_KEY=  # Utiliser IAM Role à la place

# ============================================
# URLs des services (production)
# ============================================
# Remplacez par votre IP ou domaine AWS
# Format: http://<IP-PUBLIQUE>:PORT ou https://votre-domaine.com

PUBLIC_IP=XX.XX.XX.XX
# Ou si vous avez un domaine:
# PUBLIC_DOMAIN=votre-domaine.com

# URLs internes (communication entre conteneurs)
ADMIN_GATEWAY_URL=http://admin-gateway:3001
AUTHZ_URL=http://authz:3002
CORE_ORDERS_URL=http://core-orders:3007
VIGILANCE_URL=http://vigilance:3008
PALETTE_URL=http://palette:3009
AFFRET_IA_URL=http://affret-ia:3010
PLANNING_URL=http://planning:3005
NOTIFICATIONS_URL=http://notifications:3004
ECPMR_URL=http://ecpmr:3014
STORAGE_MARKET_URL=http://storage-market:3015
GEO_TRACKING_URL=http://geo-tracking:3016
CHATBOT_URL=http://chatbot:3019

# URLs publiques (pour les frontends)
NEXT_PUBLIC_ADMIN_GATEWAY_URL=http://${PUBLIC_IP}:3001
NEXT_PUBLIC_AUTHZ_URL=http://${PUBLIC_IP}:3002
NEXT_PUBLIC_CORE_ORDERS_API=http://${PUBLIC_IP}:3007
NEXT_PUBLIC_PALETTE_API_URL=http://${PUBLIC_IP}:3009
NEXT_PUBLIC_STORAGE_MARKET_URL=http://${PUBLIC_IP}:3015
NEXT_PUBLIC_CHATBOT_URL=http://${PUBLIC_IP}:3019
NEXT_PUBLIC_SUPPORT_URL=https://www.votre-domaine.com

# ============================================
# CORS Configuration
# ============================================
# Autorisez vos domaines frontend
CORS_ALLOW_ORIGIN=http://${PUBLIC_IP},https://www.votre-domaine.com,https://admin.votre-domaine.com

# ============================================
# Security Settings
# ============================================
NODE_ENV=production
SECURITY_ENFORCE=true

# ============================================
# Vigilance & Planning
# ============================================
VIGILANCE_TTL_MS=300000
ENTITLEMENTS_TTL_MS=300000
PLANNING_PORT=3005

# ============================================
# Redis Configuration
# ============================================
REDIS_URL=redis://redis:6379

# ============================================
# Ports des services (interne Docker)
# ============================================
ADMIN_GATEWAY_PORT=3001
AUTHZ_PORT=3002
NOTIFICATIONS_PORT=3004
PLANNING_PORT=3005
TMS_SYNC_PORT=3006
VIGILANCE_PORT=3008
PALETTE_PORT=3009
AFFRET_IA_PORT=3010
TRAINING_PORT=3012
ECPMR_PORT=3014

# ============================================
# INSTRUCTIONS DE CONFIGURATION
# ============================================
#
# 1. Copiez ce fichier en .env:
#    cp .env.production .env
#
# 2. Remplacez TOUTES les valeurs "CHANGEZ_MOI" et "VOTRE_CLE"
#
# 3. Remplacez XX.XX.XX.XX par l'IP publique de votre instance EC2
#
# 4. Générez des tokens forts:
#    node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# 5. Vérifiez que toutes les API keys sont valides
#
# 6. Testez la configuration:
#    docker-compose -f docker-compose.production.yml config
#
# ============================================
